<!DOCTYPE html>

<html>
    <head>
        <%- include('./partials/title.ejs') %>
        <link rel="stylesheet" href="./css/index_css.css">
        <link rel="stylesheet" href="./css/rooms_css.css">
        <link rel="stylesheet" href="./css/viewrooms_css.css">
        <link rel="stylesheet" href="./css/booking_css.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
        <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
        <script src="./js/login.js"></script>
        <script src="./js/register.js"></script>
        <script src="./js/booking.js"></script>
    </head>
    <body>
        <div class="container_whole" id="blur">
        <a class="top_btn" href="#top">
            <i class="fa fa-arrow-up" style="color:#fff; font-size:28px;"></i>
        </a>
        <img src="images/hotel_bg.jpg" id="bg" alt="">

        <div class="container nav_main">
            <nav class="navbar navbar-expand-lg nav_options">
                <div class="navbar-brand hotel_name_nav">robotel</div>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
                    <i class="fa fa-bars" style="color:#fff; font-size:28px;"></i>
                  </span>
                </button>
                <div class="collapse navbar-collapse justify-content-start" id="navbarNavAltMarkup">
                  <div class="navbar-nav ml-auto text-right float-right">
                    <a class="nav-item nav-link" href="index">Home <span class="sr-only">(current)</span></a>
                    <a class="nav-item nav-link" href="rooms">Rooms</a>
                    <a class="nav-item nav-link" href="services">Services</a>
                    <a class="nav-item nav-link" href="#contactus_section">Contact Us</a>
                    
                    <%- include('./partials/account_button.ejs') %>

                  </div>
                </div>
              </nav>
        </div>
        <div class="container hotel_header" style="justify-content: flex-end; align-items: flex-start;">
            <div class="hotel_type">
                Rooms
            </div>
            <div class="viewrooms_header">
                <%-room.Type%> Room
            </div>
            <div class="room_price">
                â‚±<%-room.Price%>.00 PER NIGHT
            </div>
        </div>
        <div class="container-fluid px-0 content_con" style="margin-top: 100px;">
            <%- include('./partials/view_rooms_book_header.ejs') %>
            <div class="container-fluid">
                <div class="container pb-5">
                    <div class="row">
                        <div class="col-sm-8 p-5 viewrooms_description">
                            <%-room.Description%>
                        </div>
                        <div class="col-sm-4 py-5 viewrooms_details">
                            <div>
                                <div style="font-weight: 500;">DETAILS:</div>
                                <ul>
                                        <li>Separate toilet</li>
                                        <li>Flatscreen</li>
                                        <li>Wifi</li>
                                        <li><%-room.BedInfo%></li>
                                        <li>No. of guests allowed: <%-room.NumberOfGuests%></li>
                                        <li>No. of additional guests allowed: <%-room.NumberOfAdditionalGuests%></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="container pb-5" style="padding-left: 150px; padding-right: 150px;">
                        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                            <ol class="carousel-indicators">
                              <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                              <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                              <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                            </ol>
                            <div class="carousel-inner">
                              <div class="carousel-item active">
                                <img class="d-block w-100" src="./images/<%-room.Type.toLowerCase()%>.jpg" alt="First slide">
                              </div>
                              <div class="carousel-item ">
                                <img class="d-block w-100" src="./images/hotel_bg.jpg" alt="Second slide">
                              </div>
                              <div class="carousel-item ">
                                <img class="d-block w-100" src="./images/hotel_bg.jpg" alt="Third slide">
                              </div>
                            </div>
                            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="sr-only">Previous</span>
                            </a>
                            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="sr-only">Next</span>
                            </a>
                        </div>
                    </div>
                    
                </div>
            </div>
            
        </div>
       
        <%- include('./partials/footer.ejs') %>
    </div>

    <div class="modal fade modal_success" id="registration_modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" data-backdrop="false">
        <div class="modal-dialog modal-dialog-centered" style="width: 350px;" role="document">
            <div class="modal-content border-0 px-3 pb-2">
                <div class="modal-header">
                  <h5 class="modal-title my-auto mr-5" id="data_modal_text"></h5>
                  </div>
                  <div class="modal-footer">
                  <span class="btn_close_success">
                      <button id="ok_btn" class="btn btn_booknow" data-dismiss="modal">OK</button>
                  </span>
                </div>
            </div>
        </div>
      </div>

    <%- include('./partials/account_popup.ejs') %>

        <script>
            var dates = [];
            // set default dates
            var start = new Date();
            var defaultDate = new Date(start.getFullYear(), start.getMonth(), start.getDate());
            var newMinDate;
            // set end date to max one year period:
            var end = new Date(new Date().setYear(start.getFullYear()+1));

            let roomfield = $('#room');

            // check in/out fields
            let checkindatepicker, checkoutdatepicker;
            checkoutdatepicker = $('#checkout').datepicker({
                uiLibrary: 'bootstrap4',
                format: 'mm-dd-yyyy',
                todayHighlight: true,
                minDate: defaultDate,
                disableDates: function(date){
                  if(date && dates.indexOf(((date.getMonth() + 1) + "-" + date.getDate() + "-" + date.getFullYear())) > -1){
                    return false;
                  }
                  else{
                    return true;
                  }
                }
              });

            checkindatepicker = $('#checkin').datepicker({
                uiLibrary: 'bootstrap4',
                format: 'mm-dd-yyyy',
                todayHighlight: true,
                minDate: defaultDate,
                disableDates: function(date){
                  if(date && dates.indexOf(((date.getMonth() + 1) + "-" + date.getDate() + "-" + date.getFullYear())) > -1){
                    return false;
                  }
                  else{
                    return true;
                  }
                }
            }).on("change", function(){
                checkoutdatepicker.datepicker('destroy');
                let tempDate = new Date($(this).val());
                tempDate.setDate(tempDate.getDate() + 1);
                checkoutdatepicker.datepicker({
                    uiLibrary: 'bootstrap4',
                    format: 'mm-dd-yyyy',
                    todayHighlight: true,
                    minDate: tempDate,
                    disableDates: function(date){
                    if(date && dates.indexOf(((date.getMonth() + 1) + "-" + date.getDate() + "-" + date.getFullYear())) > -1){
                        return false;
                    }
                    else{
                        return true;
                    }
                    }
                });
            });

            roomfield.on("change", function(){
                check_available_rooms();
            });

            function check_available_rooms(){
                var Room = {
                    Type: $('#room').val()
                }
                $.get('check_available_rooms', {Room}, function(result){
                let i;
                dates = [];
                for(i = 0; i < result.length; i++){
                    dates[i] = new Date(result[i]);
                    dates[i] = ((dates[i].getMonth() + 1) + '-' + dates[i].getDate() + '-' + dates[i].getFullYear())
                }
                resetdate();
              });
            }

            function resetdate(){
                checkindatepicker.datepicker('destroy');
                checkindatepicker.datepicker({
                    uiLibrary: 'bootstrap4',
                    format: 'mm-dd-yyyy',
                    todayHighlight: true,
                    minDate: defaultDate,
                    disableDates: function(date){
                        if(date && dates.indexOf(((date.getMonth() + 1) + "-" + date.getDate() + "-" + date.getFullYear())) > -1){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                }).on("change", function(){
                checkoutdatepicker.datepicker('destroy');
                let tempDate = new Date($(this).val());
                tempDate.setDate(tempDate.getDate() + 1);
                checkoutdatepicker.datepicker({
                    uiLibrary: 'bootstrap4',
                    format: 'mm-dd-yyyy',
                    todayHighlight: true,
                    minDate: tempDate,
                    disableDates: function(date){
                        if(date && dates.indexOf(((date.getMonth() + 1) + "-" + date.getDate() + "-" + date.getFullYear())) > -1){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                })
                });

                checkoutdatepicker.datepicker('destroy');
                checkoutdatepicker.datepicker({
                    uiLibrary: 'bootstrap4',
                    format: 'mm-dd-yyyy',
                    todayHighlight: true,
                    minDate: defaultDate,
                    disableDates: function(date){
                        if(date && dates.indexOf(((date.getMonth() + 1) + "-" + date.getDate() + "-" + date.getFullYear())) > -1){
                            return false;
                        }
                        else{
                            return true;
                        }
                    }
                });
            }
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script type="text/javascript">
            function toggle(){
                var blur = document.getElementById('blur');
                blur.classList.toggle('active');
                var popup = document.getElementById('popup');
                popup.classList.toggle('active');

                $("#form_login").show();
                $("#form_admin").hide();
                $("#form_createaccount").hide();
                $("#login_error").hide();
                $("#register_error").hide();
            }
            function create_acc() {
                $("#form_login").hide();
                $("#form_createaccount").show();
                $("#form_admin").hide();
                $("#register_error").hide();
            }
            function login() {
                $("#form_login").show();
                $("#form_createaccount").hide();
                $("#form_admin").hide();
                $("#login_error").hide();
            }
            function admin_login() {
                $("#form_admin").show();
                $("#form_login").hide();
                $("#admin_error").hide();
                $("#form_createaccount").hide();
                
            }
            function prebook(){
                var Checkin = $('#checkin').val()
                var Checkout = $('#checkout').val()
                var RoomType = $('#room').val()
                localStorage.setItem("Checkin", Checkin)
                localStorage.setItem("Checkout", Checkout)
                localStorage.setItem("RoomType", RoomType)
            }
        </script>
    </body>
</html>